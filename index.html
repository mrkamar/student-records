<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Student Records Search</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  /* Base */
  body {
    margin: 0;
    padding: 0;
    background-color: #121214;
    color: #e0e0e0;
    font-family: 'Fira Mono', Consolas, 'Courier New', monospace;
    overflow-x: hidden;
  }

  /* Navigation */
  .nav-container {
    max-width: 100%;
    margin: 20px auto;
    padding: 0 15px;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .nav-btn {
    background-color: #333;
    border: 1px solid #7affc4;
    color: #7affc4;
    padding: 8px 15px;
    border-radius: 6px;
    text-decoration: none;
    font-family: 'Fira Mono', monospace;
    transition: all 0.3s ease;
    font-size: 14px;
    white-space: nowrap;
  }
  
  .nav-btn:hover {
    background-color: #7affc4;
    color: #121214;
  }

  /* Main container */
  .main-container {
    max-width: 100%;
    width: 95%;
    margin: 0 auto;
    padding: 0 10px;
    box-sizing: border-box;
  }

  /* Login container */
  .login-container {
    background: linear-gradient(145deg, #1f2024, #18191d);
    border-radius: 12px;
    max-width: 500px;
    width: 100%;
    margin: 20px auto;
    padding: 20px;
    box-shadow:
      inset 0 0 15px rgba(255, 255, 255, 0.07),
      0 4px 15px rgba(0, 0, 0, 0.7);
    color: #7affc4;
    font-size: 15px;
    line-height: 1.4;
  }

  .login-title {
    text-align: center;
    margin-bottom: 20px;
    font-size: 22px;
    color: #7affc4;
    word-break: break-word;
  }

  .login-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .form-group label {
    font-size: 14px;
  }

  .form-control {
    background: #121214;
    border: 1.8px solid #7affc4;
    color: #7affc4;
    font-size: 14px;
    padding: 10px 12px;
    border-radius: 6px;
    font-family: 'Fira Mono', monospace;
    transition: border-color 0.3s ease;
    width: 100%;
    box-sizing: border-box;
  }

  .form-control:focus {
    outline: none;
    border-color: #55e6b8;
    box-shadow: 0 0 12px #55e6b888;
    background-color: #18191d;
  }

  .btn {
    background-color: #55e6b8;
    border: none;
    padding: 12px;
    color: #121214;
    font-weight: 600;
    font-size: 14px;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Fira Mono', monospace;
    transition: background-color 0.3s ease;
    margin-top: 8px;
    width: 100%;
    box-sizing: border-box;
  }

  .btn:hover { background-color: #7affc4; }
  .btn:disabled {
    background-color: #555;
    cursor: not-allowed;
  }

  /* Locked state */
  .system-locked {
    position: relative;
  }
  
  .system-locked::after {
    content: "ðŸ”’ SYSTEM LOCKED";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: #ff4e4e;
    border-radius: 12px;
    z-index: 10;
    padding: 0 10px;
    text-align: center;
  }

  /* Search section */
  .search-section {
    max-width: 100%;
    width: 100%;
    margin: 15px auto;
    padding: 12px 15px;
    background: #1f2024;
    border-radius: 10px;
    display: none;
    flex-wrap: wrap;
    gap: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    align-items: center;
    box-sizing: border-box;
  }

  .search-section select, 
  .search-section input[type="text"] {
    background: #121214;
    border: 1.8px solid #7affc4;
    color: #7affc4;
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 6px;
    flex-grow: 1;
    min-width: 120px;
    width: 100%;
    font-family: 'Fira Mono', monospace;
    transition: border-color 0.3s ease;
    box-sizing: border-box;
  }

  .search-section select:focus, 
  .search-section input[type="text"]:focus {
    outline: none;
    border-color: #55e6b8;
    box-shadow: 0 0 10px #55e6b888;
    background-color: #18191d;
  }

  .search-section button {
    background-color: #55e6b8;
    border: none;
    padding: 10px 20px;
    color: #121214;
    font-weight: 600;
    font-size: 14px;
    border-radius: 8px;
    cursor: pointer;
    flex-shrink: 0;
    font-family: 'Fira Mono', monospace;
    transition: background-color 0.3s ease;
    width: 100%;
    box-sizing: border-box;
  }

  .search-section button:hover { background-color: #7affc4; }

  /* Results container */
  #results {
    max-width: 100%;
    width: 100%;
    margin: 15px auto 25px;
    background: #1f2024;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    padding: 10px;
    overflow-x: auto;
    word-break: break-word;
    display: none;
    box-sizing: border-box;
  }

  #results table {
    width: 100%;
    border-collapse: collapse;
    color: #7affc4;
    font-family: 'Fira Mono', monospace;
    font-size: 13px;
    table-layout: fixed;
    min-width: 600px;
  }

  #results th, #results td {
    padding: 6px 8px;
    border-bottom: 1px solid #333;
    text-align: left;
    word-wrap: break-word;
  }

  #results th { 
    border-bottom: 2px solid #55e6b8;
    font-size: 14px;
  }

  #results tr:hover { background-color: #33373d; }

  #results a {
    color: #7affc4;
    text-decoration: underline;
    cursor: pointer;
    transition: color 0.3s ease;
    word-break: break-all;
  }

  #results a:hover { color: #55e6b8; }

  /* Welcome message */
  .welcome-message {
    text-align: center;
    margin: 15px auto;
    max-width: 100%;
    width: 100%;
    display: none;
    padding: 0 10px;
    box-sizing: border-box;
  }

  .welcome-message h3 {
    font-size: 18px;
    margin: 10px 0;
    word-break: break-word;
  }

  /* Logout button */
  .logout-btn {
    background-color: #ff4e4e;
    border: none;
    padding: 6px 12px;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    margin-left: 10px;
    font-family: 'Fira Mono', monospace;
    font-size: 13px;
    display: none;
    white-space: nowrap;
  }

  /* Progress bar */
  #progress-container {
    max-width: 100%;
    width: 100%;
    margin: 10px auto 0 auto;
    background: #121214;
    border-radius: 5px;
    overflow: hidden;
    height: 6px;
    box-shadow: inset 0 0 4px #7affc4aa;
    display: none;
    box-sizing: border-box;
  }

  #progress-bar {
    height: 6px;
    background: #55e6b8;
    width: 0%;
    transition: width 0.3s ease;
  }

  /* Toast */
  #toast {
    position: fixed;
    bottom: 20px;
    right: 10px;
    left: 10px;
    background: #ff4e4e;
    color: #fff;
    padding: 12px 15px;
    border-radius: 6px;
    font-family: 'Fira Mono', monospace;
    display: none;
    z-index: 2000;
    box-shadow: 0 0 15px #ff4e4ecc;
    transition: opacity 0.4s ease;
    max-width: 100%;
    box-sizing: border-box;
    text-align: center;
  }

  #toast.success { background: #2ea043; }
  #toast.warn { background: #e2b93b; color: #121214; }

  /* Modal */
  .modal {
    position: fixed;
    top: 10%;
    left: 5%;
    right: 5%;
    width: 90%;
    max-width: 600px;
    background-color: #1f2024;
    color: #7affc4;
    border-radius: 12px;
    box-shadow: 0 0 25px #55e6b8aa;
    padding: 20px;
    font-family: 'Fira Mono', monospace;
    font-size: 14px;
    white-space: pre-wrap;
    user-select: text;
    display: none;
    z-index: 1200;
    max-height: 80vh;
    overflow-y: auto;
    box-sizing: border-box;
  }

  .modal-close {
    position: absolute;
    top: 8px;
    right: 12px;
    font-size: 22px;
    color: #ff7070;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    background: transparent;
    border: none;
  }

  #studentModalTitle {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 18px;
    word-break: break-word;
  }

  #studentPhoto {
    width: 100px;
    max-width: 100%;
    border-radius: 6px;
    margin: 0 auto 10px auto;
    display: none;
  }

  #modalContent {
    font-size: 13px;
    line-height: 1.4;
    word-break: break-word;
    white-space: pre-wrap;
    overflow-wrap: break-word;
  }

  @media (max-width: 600px) {
    .nav-container {
      flex-direction: column;
      align-items: center;
    }
    
    .logout-btn {
      margin-left: 0;
      margin-top: 8px;
    }
    
    .search-section select, 
    .search-section input[type="text"] {
      min-width: 100%;
    }
    
    #results table {
      font-size: 12px;
    }
    
    .modal {
      padding: 15px;
    }
  }
</style>
</head>
<body>
  <!-- Navigation -->
  <div class="nav-container">
    <a href="index.html" class="nav-btn">Home</a>
    <a href="about.html" class="nav-btn">About</a>
    <a href="result.html" class="nav-btn">Result Portal</a>
    <button class="logout-btn" id="logoutBtn">Logout</button>
  </div>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
      <h2 class="login-title">Student Login</h2>
      <form class="login-form" id="loginForm">
        <div class="form-group">
          <label for="matricNo">Matric Number</label>
          <input type="text" id="matricNo" class="form-control" placeholder="e.g., ND/21/CSC/001" required />
        </div>
        <div class="form-group">
          <label for="surname">Surname</label>
          <input type="text" id="surname" class="form-control" placeholder="Enter your surname" required />
        </div>
        <button type="submit" class="btn" id="loginBtn">Login</button>
      </form>
    </div>

    <!-- Welcome Message -->
    <div class="welcome-message" id="welcomeMessage">
      <h3>Welcome, <span id="studentName"></span></h3>
    </div>

    <!-- Search Section -->
    <div class="search-section" id="searchSection" role="search">
      <select id="dataset" title="Select Dataset" aria-label="Select dataset">
        <option value="morning">Morning (Regular)</option>
        <option value="spat">SPAT (Evening)</option>
      </select>

      <select id="searchMode" title="Search Mode" aria-label="Search mode">
        <option value="default">Contains</option>
        <option value="exact">Exact Match</option>
        <option value="regex">Regex</option>
        <option value="column">Column Filter</option>
      </select>

      <input type="text" id="search" placeholder="Enter Name, Matric No, etc" title="Search input" aria-label="Search field" />

      <input type="text" id="adminKey" placeholder="Admin Key for override" title="Admin override key" aria-label="Admin override key" />

      <button id="searchBtn" type="button" aria-label="Search">Search</button>
    </div>

    <div id="progress-container" aria-hidden="true">
      <div id="progress-bar"></div>
    </div>

    <div id="results" aria-live="polite"></div>
  </div>

  <!-- Modal -->
  <div class="modal" id="studentModal" role="dialog" aria-modal="true" aria-labelledby="studentModalTitle" aria-hidden="true">
    <button id="closeModalBtn" class="modal-close" aria-label="Close details">Ã—</button>
    <h2 id="studentModalTitle">Student Details</h2>
    <img id="studentPhoto" src="" alt="Student Photo" />
    <pre id="modalContent" tabindex="0"></pre>
  </div>

  <div id="toast" role="status" aria-live="polite"></div>

<script>
  const urls = {
    morning: "https://raw.githubusercontent.com/mrkamar/student-records/refs/heads/main/morning.csv",
    spat: "https://raw.githubusercontent.com/mrkamar/student-records/refs/heads/main/spat.csv",
    command: "https://raw.githubusercontent.com/mrkamar/student-records/refs/heads/main/command.json",
  };

  // DOM Elements
  const loginContainer = document.getElementById("loginContainer");
  const loginForm = document.getElementById("loginForm");
  const loginBtn = document.getElementById("loginBtn");
  const welcomeMessage = document.getElementById("welcomeMessage");
  const studentNameEl = document.getElementById("studentName");
  const searchSection = document.getElementById("searchSection");
  const resultsEl = document.getElementById("results");
  const progressContainer = document.getElementById("progress-container");
  const progressBar = document.getElementById("progress-bar");
  const searchBtn = document.getElementById("searchBtn");
  const searchInput = document.getElementById("search");
  const searchModeEl = document.getElementById("searchMode");
  const modal = document.getElementById("studentModal");
  const closeModalBtn = document.getElementById("closeModalBtn");
  const modalContent = document.getElementById("modalContent");
  const studentPhoto = document.getElementById("studentPhoto");
  const logoutBtn = document.getElementById("logoutBtn");

  // System state
  let systemLocked = false;
  let currentStudent = null;

  /* ------------ Utilities ------------ */
  function showToast(message, type = "error", duration = 3000) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = "";
    if (type === "success") toast.classList.add("success");
    if (type === "warn") toast.classList.add("warn");
    toast.style.display = 'block';
    toast.style.opacity = '1';
    setTimeout(() => {
      toast.style.opacity = '0';
      setTimeout(() => toast.style.display = 'none', 400);
    }, duration);
  }

  async function fetchCommand() {
    try {
      const res = await fetch(urls.command, { cache: "no-store" });
      if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
      const json = await res.json();
      return json;
    } catch (e) {
      console.error("Failed to load command.json:", e);
      return { status: "on", adminKey: "" };
    }
  }

  async function fetchCSVData(url) {
    try {
      const response = await fetch(url, { cache: "no-store" });
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      return await response.text();
    } catch (error) {
      console.error("Error fetching CSV data:", error);
      throw error;
    }
  }

  function parseCSV(csvText) {
    const lines = csvText.trim().split("\n");
    const headers = lines[0].replace(/"/g, "").split(",");

    return lines.slice(1).map((line) => {
      const cells = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)
                        ?.map((cell) => cell.replace(/"/g, "")) || [];
      let obj = {};
      headers.forEach((h, i) => (obj[h.trim()] = (cells[i] ?? "").trim()));
      return obj;
    });
  }

  /* ------------ Session Management ------------ */
  function saveSession(student) {
    localStorage.setItem('loggedIn', 'true');
    localStorage.setItem('studentName', `${student["Surname"]} ${student["Othernames"] || ''}`);
    localStorage.setItem('studentData', JSON.stringify(student));
  }

  function clearSession() {
    localStorage.removeItem('loggedIn');
    localStorage.removeItem('studentName');
    localStorage.removeItem('studentData');
  }

  function checkSession() {
    return localStorage.getItem('loggedIn') === 'true';
  }

  function loadSession() {
    if (checkSession()) {
      currentStudent = JSON.parse(localStorage.getItem('studentData'));
      studentNameEl.textContent = localStorage.getItem('studentName');
      showLoggedInState();
    }
  }

  function showLoggedInState() {
    loginContainer.style.display = "none";
    welcomeMessage.style.display = "block";
    searchSection.style.display = "flex";
    resultsEl.style.display = "block";
    logoutBtn.style.display = "block";
  }

  function logout() {
    clearSession();
    currentStudent = null;
    loginContainer.style.display = "block";
    welcomeMessage.style.display = "none";
    searchSection.style.display = "none";
    resultsEl.style.display = "none";
    logoutBtn.style.display = "none";
    showToast("You have been logged out", "success");
  }

  /* ------------ System Lock Handling ------------ */
  async function checkSystemStatus() {
    try {
      const cmd = await fetchCommand();
      systemLocked = cmd.status === "off";
      
      if (systemLocked) {
        loginContainer.classList.add("system-locked");
        loginBtn.disabled = true;
        
        const lockMessage = cmd.message || "The system is currently locked by administrator.";
        showToast(lockMessage, "warn", 5000);
        
        if (checkSession()) {
          logout();
        }
      } else {
        loginContainer.classList.remove("system-locked");
        loginBtn.disabled = false;
      }
    } catch (error) {
      console.error("Error checking system status:", error);
    }
  }

  /* ------------ Login Functionality ------------ */
  loginForm.addEventListener("submit", async function(e) {
    e.preventDefault();
    
    if (systemLocked) {
      showToast("System is locked. Please try again later.", "warn");
      return;
    }
    
    const matricNo = document.getElementById("matricNo").value.trim();
    const surname = document.getElementById("surname").value.trim();
    
    if (!matricNo || !surname) {
      showToast("Please enter both matric number and surname", "warn");
      return;
    }

    try {
      loginBtn.disabled = true;
      loginBtn.textContent = "Verifying...";

      const [morningData, spatData] = await Promise.all([
        fetchCSVData(urls.morning),
        fetchCSVData(urls.spat)
      ]);

      const morningRecords = parseCSV(morningData);
      const spatRecords = parseCSV(spatData);

      const foundStudent = [...morningRecords, ...spatRecords].find(student => {
        const studentMatric = (student["Matric No"] || "").toLowerCase().trim();
        const studentSurname = (student["Surname"] || "").toLowerCase().trim();
        return studentMatric === matricNo.toLowerCase() && 
               studentSurname === surname.toLowerCase();
      });

      if (foundStudent) {
        currentStudent = foundStudent;
        saveSession(foundStudent);
        showToast("Login successful!", "success");
        studentNameEl.textContent = `${foundStudent["Surname"]} ${foundStudent["Othernames"] || ''}`;
        showLoggedInState();
      } else {
        showToast("Invalid credentials. Please try again.", "error");
      }
    } catch (error) {
      console.error("Login error:", error);
      showToast("Error verifying credentials. Please try again.", "error");
    } finally {
      loginBtn.disabled = false;
      loginBtn.textContent = "Login";
    }
  });

  /* ------------ Search Functionality ------------ */
  async function performSearch() {
    const keyEntered = document.getElementById("adminKey").value.trim();
    const rawSearchVal = searchInput.value.trim();
    const selected = document.getElementById("dataset").value;
    const mode = searchModeEl.value;
    const csvUrl = urls[selected];

    if (!rawSearchVal) {
      showToast("Please enter search text.", "warn");
      searchInput.focus();
      return;
    }

    const cmd = await fetchCommand();
    systemLocked = cmd.status === "off";

    if (systemLocked) {
      if (keyEntered !== cmd.adminKey) {
        const shutdownMsg = cmd.message || "Tool is currently disabled by admin control.";
        showToast(shutdownMsg + " Enter a valid override key to continue.", "warn", 4000);
        resultsEl.innerHTML = "";
        return;
      }
    }

    progressContainer.style.display = "block";
    progressBar.style.width = "0%";

    try {
      const csv = await fetchCSVData(csvUrl);
      const records = parseCSV(csv);

      const searchValLower = rawSearchVal.toLowerCase();
      const isQuoted = /^"(.*)"$/.test(rawSearchVal);
      let matched = [];

      if (mode === "regex") {
        try {
          const pattern = new RegExp(rawSearchVal, "i");
          matched = records.filter(row =>
            Object.values(row).some(val => val && pattern.test(val))
          );
        } catch (e) {
          showToast("Invalid regex pattern.", "warn");
          return;
        }
      } else if (mode === "exact" || isQuoted) {
        const needle = isQuoted ? rawSearchVal.slice(1, -1).toLowerCase() : searchValLower;
        matched = records.filter(row =>
          Object.values(row).some(val => val && val.toLowerCase() === needle)
        );
      } else if (mode === "column") {
        const parts = rawSearchVal.split(":");
        if (parts.length === 2) {
          const col = parts[0].trim().toLowerCase();
          const val = parts[1].trim().toLowerCase();
          matched = records.filter(row =>
            Object.entries(row).some(
              ([k, v]) => k.toLowerCase() === col && (v || "").toLowerCase().includes(val)
            )
          );
        } else {
          showToast("Column filter must be in format: column:value", "warn");
          return;
        }
      } else {
        matched = records.filter(row =>
          Object.values(row).some(val => val && val.toLowerCase().includes(searchValLower))
        );
      }

      if (matched.length === 0) {
        resultsEl.innerHTML = "<p>No match found.</p>";
        return;
      }

      let html = "<table><tr><th>Matric No</th><th>Surname</th><th>Othernames</th></tr>";
      matched.forEach((row) => {
        const linkData = encodeURIComponent(JSON.stringify(row));
        html += `<tr>
          <td><a href="#" data-record="${linkData}" class="detail-link">${row["Matric No"]}</a></td>
          <td>${row["Surname"] || "-"}</td>
          <td>${row["Othernames"] || "-"}</td>
        </tr>`;
      });
      html += "</table>";

      resultsEl.innerHTML = html;

      resultsEl.querySelectorAll(".detail-link").forEach(a => {
        a.addEventListener("click", (ev) => {
          ev.preventDefault();
          const record = JSON.parse(decodeURIComponent(a.getAttribute("data-record")));
          showDetails(record, a);
        });
      });

    } catch (err) {
      console.error("Search error:", err);
      showToast("Error: Failed to load student data.", "error", 4000);
    } finally {
      progressBar.style.width = "100%";
      setTimeout(() => {
        progressContainer.style.display = "none";
        progressBar.style.width = "0%";
      }, 500);
    }
  }

  /* ------------ Modal Functionality ------------ */
  let lastFocusedBeforeModal = null;

  function focusableElementsIn(el) {
    return el.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
  }

  function openModal() {
    modal.style.display = "block";
    modal.setAttribute("aria-hidden", "false");
    const focusables = focusableElementsIn(modal);
    (focusables[0] || modal).focus();
    document.body.style.overflow = "hidden";
  }

  function closeModal() {
    modal.style.display = "none";
    modal.setAttribute("aria-hidden", "true");
    document.body.style.overflow = "";
    if (lastFocusedBeforeModal) lastFocusedBeforeModal.focus();
  }

  closeModalBtn.addEventListener("click", closeModal);
  document.addEventListener('keydown', (e) => {
    if (modal.style.display === 'block') {
      if (e.key === 'Escape') {
        e.preventDefault();
        closeModal();
        return;
      }
      if (e.key === 'Tab') {
        const focusables = Array.from(focusableElementsIn(modal)).filter(el => el.offsetParent !== null);
        if (!focusables.length) return;
        const first = focusables[0];
        const last = focusables[focusables.length - 1];
        if (e.shiftKey && document.activeElement === first) {
          e.preventDefault(); last.focus();
        } else if (!e.shiftKey && document.activeElement === last) {
          e.preventDefault(); first.focus();
        }
      }
    }
  });

  function showDetails(record, triggerEl = null) {
    lastFocusedBeforeModal = triggerEl || document.activeElement;

    const content = Object.entries(record)
      .map(([k, v]) => `${k}: ${v || "-"}`)
      .join("\n");
    modalContent.innerText = content;

    const rawMatric = record["Matric No"] || "";
    const cleanMatric = rawMatric.replace(/\//g, "");

    const selectedDataset = document.getElementById("dataset").value;

    let photoBase = "";
    if (selectedDataset === "morning") {
      photoBase = "https://www.auchipoly-online.com/adm/photoreg/";
    } else if (selectedDataset === "spat") {
      photoBase = "https://www.auchipolyspats.com/adm/photoreg/";
    }

    const timestamp = Date.now();
    const photoUrl = `${photoBase}${cleanMatric}.jpg?t=${timestamp}`;

    studentPhoto.src = photoUrl;
    studentPhoto.alt = `Student Photo for ${rawMatric}`;
    studentPhoto.style.display = "block";

    studentPhoto.onerror = () => {
      studentPhoto.onerror = null;
      studentPhoto.src = "https://via.placeholder.com/120x160.png?text=No+Photo";
    };

    openModal();
  }

  /* ------------ Event Listeners ------------ */
  searchBtn.addEventListener("click", performSearch);
  searchInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") performSearch();
  });

  logoutBtn.addEventListener("click", logout);

  /* ------------ Initialize ------------ */
  document.addEventListener('DOMContentLoaded', () => {
    loadSession();
    checkSystemStatus();
    setInterval(checkSystemStatus, 5 * 60 * 1000);
  });
</script>
</body>
</html>
